import { Level } from "@/types/level.ts";
import { Event } from "@/types/event.ts";

export const stubCh1Level: Level = {
  nid: "1",
  name: "Ch. 1: Escape!",
  tilemap: "Chapter 1",
  bg_tilemap: null,
  party: "Eirika",
  music: {
    player_phase: "Distant Roads",
    enemy_phase: "Shadow of the Enemy",
    other_phase: null,
    enemy2_phase: null,
    player_battle: "Attack",
    enemy_battle: "Defense",
    other_battle: null,
    enemy2_battle: null,
  },
  objective: {
    simple: "Seize Gate",
    win: "Seize Boss",
    loss: "Eirika dies",
  },
  roam: false,
  roam_unit: null,
  go_to_overworld: true,
  should_record: true,
  units: [
    {
      nid: "Eirika",
      team: "player",
      ai: "None",
      roam_ai: null,
      ai_group: null,
      starting_position: [2, 2],
      starting_traveler: null,
      generic: false,
    },
    {
      nid: "Bozla",
      team: "player",
      ai: "None",
      roam_ai: null,
      ai_group: null,
      starting_position: [4, 6],
      starting_traveler: null,
      generic: false,
    },
    // {
    //   nid: "Seth",
    //   team: "player",
    //   ai: "None",
    //   roam_ai: null,
    //   ai_group: null,
    //   starting_position: [13, 8],
    //   starting_traveler: null,
    //   generic: false,
    // },
    // {
    //   nid: "Gilliam",
    //   team: "player",
    //   ai: "None",
    //   roam_ai: null,
    //   ai_group: null,
    //   starting_position: [6, 1],
    //   starting_traveler: null,
    //   generic: false,
    // },
    // {
    //   nid: "Franz",
    //   team: "player",
    //   ai: "None",
    //   roam_ai: null,
    //   ai_group: null,
    //   starting_position: [5, 1],
    //   starting_traveler: null,
    //   generic: false,
    // },
    {
      nid: "Breguet",
      team: "enemy",
      ai: "Guard",
      roam_ai: null,
      ai_group: null,
      starting_position: [2, 3],
      starting_traveler: null,
      generic: false,
    },
    {
      nid: "101",
      variant: null,
      level: 2,
      klass: "Soldier",
      faction: "Soldier",
      starting_items: [["Iron_Lance", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Defend",
      roam_ai: null,
      ai_group: "",
      starting_position: [1, 3],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "102",
      variant: null,
      level: 2,
      klass: "Soldier",
      faction: "Soldier",
      starting_items: [["Iron_Lance", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Defend",
      roam_ai: null,
      ai_group: "",
      starting_position: [3, 3],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "103",
      variant: null,
      level: 2,
      klass: "Fighter",
      faction: "Soldier",
      starting_items: [["Iron_Axe", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Defend",
      roam_ai: null,
      ai_group: "",
      starting_position: [2, 8],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "104",
      variant: null,
      level: 2,
      klass: "Fighter",
      faction: "Soldier",
      starting_items: [["Iron_Axe", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Attack",
      roam_ai: null,
      ai_group: "",
      starting_position: [4, 7],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "105",
      variant: null,
      level: 2,
      klass: "Fighter",
      faction: "Soldier",
      starting_items: [["Iron_Axe", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Attack",
      roam_ai: null,
      ai_group: "",
      starting_position: [9, 5],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "106",
      variant: null,
      level: 3,
      klass: "Soldier",
      faction: "Soldier",
      starting_items: [["Iron_Lance", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Guard",
      roam_ai: null,
      ai_group: "",
      starting_position: [8, 3],
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "107",
      variant: null,
      level: 2,
      klass: "Soldier",
      faction: "Soldier",
      starting_items: [["Iron_Lance", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Pursue",
      roam_ai: null,
      ai_group: "",
      starting_position: null,
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "108",
      variant: null,
      level: 1,
      klass: "Fighter",
      faction: "Soldier",
      starting_items: [["Iron_Axe", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Attack",
      roam_ai: null,
      ai_group: "",
      starting_position: null,
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "109",
      variant: null,
      level: 1,
      klass: "Fighter",
      faction: "Soldier",
      starting_items: [["Iron_Axe", false]],
      starting_skills: [],
      team: "enemy",
      ai: "Attack",
      roam_ai: null,
      ai_group: "",
      starting_position: null,
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "GreenCav",
      variant: null,
      level: 1,
      klass: "Cavalier",
      faction: "Soldier",
      starting_items: [],
      starting_skills: [],
      team: "other",
      ai: "None",
      roam_ai: null,
      ai_group: "",
      starting_position: null,
      starting_traveler: null,
      generic: true,
    },
    {
      nid: "GreenMerc",
      variant: null,
      level: 1,
      klass: "Mercenary",
      faction: "Soldier",
      starting_items: [["Iron_Sword", false]],
      starting_skills: [],
      team: "other",
      ai: "None",
      roam_ai: null,
      ai_group: "",
      starting_position: null,
      starting_traveler: null,
      generic: true,
    },
  ],
  regions: [
    {
      nid: "House1",
      region_type: "event",
      position: [13, 6],
      size: [1, 1],
      sub_nid: "Visit",
      condition: "True",
      time_left: null,
      only_once: true,
      interrupt_move: false,
    },
    {
      nid: "House2",
      region_type: "event",
      position: [10, 4],
      size: [1, 1],
      sub_nid: "Visit",
      condition: "True",
      time_left: null,
      only_once: true,
      interrupt_move: false,
    },
    {
      nid: "Gate",
      region_type: "event",
      position: [2, 2],
      size: [1, 1],
      sub_nid: "Seize",
      condition: "unit.nid == 'Eirika'",
      time_left: null,
      only_once: false,
      interrupt_move: false,
    },
    {
      nid: "EnemyRein",
      region_type: "normal",
      position: [0, 0],
      size: [8, 10],
      sub_nid: "",
      condition: "True",
      time_left: null,
      only_once: false,
      interrupt_move: false,
    },
  ],
  unit_groups: [
    {
      nid: "Enemy1",
      units: ["Breguet", "101", "102", "103", "104", "105", "106"],
      positions: {
        Breguet: [2, 5],
        "101": [1, 6],
        "102": [3, 6],
        "106": [2, 7],
        "105": [2, 9],
        "104": [3, 8],
        "103": [1, 8],
      },
    },
    // {
    //   nid: "Rein",
    //   units: ["Gilliam", "Franz"],
    //   positions: {},
    // },
    {
      nid: "EnemyRein",
      units: ["107", "108", "109"],
      positions: {
        "107": [13, 9],
        "108": [13, 8],
        "109": [12, 9],
      },
    },
    // {
    //   nid: "EirikaSeth",
    //   units: ["Eirika", "Seth"],
    //   positions: {},
    // },
  ],
  ai_groups: [],
};

export const stubCh1Events: Event[] = [
  {
    name: "Intro",
    trigger: "level_start",
    level_nid: "1",
    condition: "True",
    commands: [],
    only_once: false,
    priority: 20,
    _source: [
      "add_talk;Eirika;Franz",
      "add_talk;Seth;Franz",
      "remove_group;Enemy1;immediate",
      "remove_group;Rein;immediate",
      "remove_group;EirikaSeth;immediate",
      "chapter_title",
      "# Fade in",
      "transition;Open",
      "# Move enemies into map",
      "spawn_group;Enemy1;South;Enemy1;;stack",
      "# Hover cursor over castle",
      "move_cursor;2,2",
      "# Flicker cursor",
      "disp_cursor;1",
      "wait;1000",
      "disp_cursor;0",
      "# Fade to inside castle",
      "transition;Close",
      "change_background;InsideCastle",
      "transition;Open",
      "add_portrait;SoldierBlue;Left;no_block",
      "add_portrait;Tana;Right",
      "speak;SoldierBlue;Princess Tana! Grado's forces are approaching!",
      "speak;Tana;What? So soon? Ah, we've had no time!",
      "speak;SoldierBlue;Milady, we lack the arms to defend this place. You must return to Castle Frelia.",
      "speak;Tana;I can't! Not yet. We haven't found Eirika and her companions yet.|Eirika is my friend, and she needs my help. I won't abandon her.|Oh, I know! Go and ask Father--{br}I mean King Hayden for more troops.",
      "speak;SoldierBlue;Yes, Your Highness!",
      "remove_portrait;SoldierBlue",
      "speak;Tana;Eirika, please be safe!",
      "transition;Close",
      "change_background",
      "end_skip",
      "transition;Open",
      "# Green units leave castle. Mercenary stays on castle.",
      "# Add and move cavalier",
      "add_unit;GreenCav;2,2",
      "move_unit;GreenCav;2,3",
      "# Add Mercenary",
      "add_unit;GreenMerc;2,2",
      "# Move Cavalier again",
      "move_unit;GreenCav;0,0",
      "remove_unit;GreenCav",
      "move_cursor;Breguet",
      "disp_cursor;1",
      "wait;1000",
      "disp_cursor;0",
      "# Fade in Breguet",
      "transition;Close",
      "change_background;Plains",
      "transition;Open",
      "add_portrait;SoldierRed;Left;no_block",
      "add_portrait;Breguet;Right",
      "speak;SoldierRed;Commander Breguet, the enemy appears to be fortifying its position in the castle.",
      "speak;Breguet;Hmph.|They're tenacious, but they have no hope of stopping our advance.",
      "speak;SoldierRed;What are your orders, sir?",
      "speak;Breguet;Ha! Orders? You just stand here and watch. I'll crush them myself!",
      "speak;SoldierRed;As you command, sir.",
      "transition;Close",
      "change_background",
      "transition;Open",
      "# Breguet moves and attacks Green Mercenary. He crits the mercenary.",
      "move_unit;Breguet;2,3",
      "interact_unit;Breguet;GreenMerc;crit1",
      "move_cursor;Breguet",
      "disp_cursor;1",
      "wait;1000",
      "disp_cursor;0",
      "add_portrait;Breguet;Left",
      "speak;Breguet;Ha! That's what happens when you face my lance!",
      "remove_portrait;Breguet",
      "# Units move to their final positions",
      "move_unit;Breguet;2,2",
      "move_group;Enemy1;Starting",
      "move_cursor;Breguet",
      "disp_cursor;1",
      "wait;1000",
      "disp_cursor;0",
      "transition;Close",
      "change_background;InsideCastle",
      "end_skip",
      "transition;Open",
      "add_portrait;Breguet;Left;no_block",
      "add_portrait;Tana;Right",
      "move_portrait;Tana;MidRight",
      "speak;Tana;St-stop right there!|Call off your forces and turn back, or you'll have me to deal with!",
      "speak;Breguet;Is that so? And who might you be?",
      "speak;Tana;Who--? I am Tana, Princess of Frelia.|I will not permit you to abuse my country any longer.",
      "speak;Breguet;Frelia's royal brat, huh? How convenient...",
      "speak;Tana;Leave this castle immediately.|If you harm me, my father and brother will chase you to the earth's end.",
      "speak;Breguet;Yes, I've heard how King Hayden dotes on his precious little daughter.|Let's see how true that is. You'll make us a fine hostage, my dear.|Seize the girl and lock her up!",
      "add_portrait;SoldierRed;FarRight",
      "speak;SoldierRed;Right away, sir!",
      "bop_portrait;Tana",
      "speak;Tana;No! Let me go!",
      "transition;Close",
      "change_background",
      "end_skip",
      "transition;Open",
      "# Eirika and Seth arrive",
      "spawn_group;EirikaSeth;East;Starting",
      "move_cursor;Eirika",
      "disp_cursor;1",
      "wait;1000",
      "disp_cursor;0",
      "add_portrait;Eirika;Right;no_block",
      "add_portrait;Seth;Left",
      "speak;Eirika;Seth, look...",
      "speak;Seth;I see it. It seems like Grado's army has already reached Frelia.|Princess, this place is perilous.|We should bypass Mulan altogether and head straight to the castle.",
      "speak;Eirika;But we can't just ignore this...|You were there when Renais was invaded... You saw what I saw.|You saw how the people suffered at the hands of Grado's soldiers.|Homes were destroyed, possessions stolen, women kidnapped...|Anyone who resisted was executed without question, without hesitation.",
      "speak;Seth;...",
      "speak;Eirika;Please, Seth. I can't allow that to happen here.|I don't want to see any more people harmed by Grado's atrocities.",
      "speak;Seth;All right, Princess. I understand. Perhaps we can retake Mulan.|But, Princess, you must act with caution. Your people need you, too.",
      "speak;Eirika;Of course, Seth. Come on! Let's go!",
      "remove_portrait;Seth;no_block",
      "remove_portrait;Eirika",
    ],
  },
  {
    name: "Seize",
    trigger: "Seize",
    level_nid: "1",
    condition: "'Lord' in unit.tags",
    commands: [],
    only_once: false,
    priority: 20,
    _source: ["win_game"],
  },
  {
    name: "Outro",
    trigger: "level_end",
    level_nid: "1",
    condition: "True",
    commands: [],
    only_once: false,
    priority: 20,
    _source: [
      "# Fade to black",
      "transition;Close",
      "change_background;InsideCastle",
      "transition;Open",
      "add_portrait;Tana;Left;no_block",
      "add_portrait;Gilliam;MidRight",
      "speak;Gilliam;Princess Tana.",
      "speak;Tana;Sir Gilliam...|I'm sorry. I never meant to cause you such trouble.",
      "speak;Gilliam;It was no trouble. I live to serve, Princess.",
      "# Move Eirika onscreen from offscreen",
      "add_portrait;Eirika;OffscreenRight;immediate",
      "move_portrait;Eirika;FarRight",
      "speak;Eirika;Tana!",
      "speak;Tana;...Eirika?!?|Is that really you?",
      "speak;Eirika;Tana, what are you doing, so far from Castle Frelia?",
      "# This is how you tell a character to change their expression",
      "expression;Tana;Smile",
      "speak;Tana;I heard that Renais had fallen, and I was so worried...|But I'm glad to see that you're safe...{w}{clear}Wait! Where is Ephraim? Is he well?",
      "expression;Tana;NoSmile",
      "speak;Eirika;I wish I knew.",
      "speak;Tana;You haven't heard from him? Oh, I hope he's not been harmed...|Come, we must go to Castle Frelia. My lord father may know something.",
      "speak;Eirika;Thank you, Tana.",
      "transition;Close",
      "end_skip",
      "",
      "# Let's have some fun in the overworld",
      "change_background",
      "# This command is necessary to load the overworld tilemap",
      "overworld_cinematic;0",
      "# The next two commands are self-explanatory. You'll use these to manipulate overworld data.",
      "reveal_overworld_node;0;immediate",
      "set_overworld_position;Eirika;0",
      "",
      "# Here are examples of overworld animations and sounds.",
      "# Notice that they are the same as the normal tilemap commands.",
      "transition;open;1500",
      "wait;1000",
      "sound;RefreshDance",
      "map_anim;AOE_Mend;2",
      "reveal_overworld_node;2",
      "wait;500",
      "sound;Mend",
      "reveal_overworld_road;0;2",
      "",
      "# Because narration is more involved than dialogue, we need some different commands",
      "# to animate the narration window in.",
      "toggle_narration_mode;open;1000",
      "wait;500",
      "narrate;Narrator;Eirika and her companions have liberated the border castle.",
      "overworld_move_unit;Eirika;2;no_block",
      "narrate;Narrator;Alongside Princess Tana of Frelia, they ride to the Frelian Capital.",
      "wait;500",
      "transition;close",
      "toggle_narration_mode;close",
      "",
      "change_background;Bedroom",
      "wait;1000",
      "transition;open",
      "add_portrait;Hayden;Left",
      "add_portrait;Tana;FarRight",
      "speak;Hayden;Oh, Tana... I'm grateful to see that you're safe and home again! |You've no idea how worried when I heard you were under attack at Border Mulan. |You are not to leave again without my permission. Do you understand?",
      "speak;Tana;Don't be mad, Father. Look, I come bearing good news. |Eirika! Come out now!",
      "add_portrait;Eirika;MidRight",
      "speak;Eirika;King Hayden, I am pleased to see you again, even in these sad times.",
      "speak;Hayden;Ah, Eirika. It does my heart good to see you safe.",
      "speak;Eirika;Thank you. I was able to escape the castle before Renais fell. |But I'm not sure if my father...",
      "speak;Hayden;Yes. |I...have received word of your father.",
      "speak;Eirika;Your Highness? Please tell me. Is my father well?",
      "speak;Hayden;...My friend King Fado...did not survive the fall of Renais Castle.",
      "speak;Eirika;...No, it cannot be...",
      "remove_portrait;Tana",
      "add_portrait;Seth;FarRight",
      "speak;Seth;......",
      "speak;Hayden;Rest assured, Grado will be punished for its cowardly act. This is Frelia's promise. |Eirika, please stay here and rest. I cannot imagine how exhaused you must be.",
      "speak;Eirika;......",
      "speak;Seth;King Hayden. |You know of Prince Ephraim's disappearance, do you not?",
      "speak;Hayden;Yes, we hear the prince and his men hound Grado at every turn. |It's said that he's led his forces into the empire itself. |Reports suggest he's crossed the border and now fights in Renvall.",
      "speak;Eirika;My brother...{br}He fights on? Even now?",
      "speak;Hayden;Yes. My pegasus knights brought his information at a great price. |Even though Renais has fallen, he still charges into the enemy's heart. |He is truly Fado's son...what a valiant youth. |I wish that I knew whether he remains unharmed, but I do not.",
      "speak;Eirika;King Hayden, I thank you for your offer, but I cannot stay. |I intend to ride to my brother's side with reinforcements.",
      "speak;Hayden;I cannot allow it. I know how you feel, but this plan is suicide. |I would be betraying Fado's memory if I allowed any harm to befall you. |Stay here. Rest and mourn. Leave this war to the warriors.",
      "speak;Eirika;I know you mean well, Your Majesty. |However, I have lost my father, and my twin brother is in peril. |My brother, he is a part of me... |I cannot rest here in peace while he risks his life.",
      "speak;Hayden;No. Renais has no more army. Grado's forces decimated it. |I wish that Frelia could provide you with support, with soldiers, but... |My son, Innes, is on his way to meet the empire's forces. |We cannot spare a single brigade. |Your own retinue of knights cannot possibly face Grado alone. |Are you so determined to go?",
      "speak;Eirika;Yes. |...With apologies.",
      "speak;Hayden;...As resolute as your father, eh? |What am I to do in the face of such foolhardy determination? |Vanessa.",
      "remove_portrait;Seth",
      "add_portrait;Vanessa;FarRight",
      "speak;Vanessa;Here, Your Highness!",
      "speak;Hayden;Moulder.",
      "remove_portrait;Vanessa",
      "add_portrait;Moulder;FarRight",
      "speak;Moulder;You called, my king?",
      "speak;Hayden;Gilliam.",
      "remove_portrait;Moulder",
      "add_portrait;Gilliam;FarRight",
      "speak;Gilliam;Yes, sire?",
      "remove_portrait;Gilliam",
      "speak;Hayden;You are to accompany Princess Eirika of Renais into Grado territory. |I expect each of you to provide aid and support for her brother.",
      "add_portrait;Moulder;FarRight",
      "speak;Moulder;Hm. Quite a grave responsibility you have given us.",
      "remove_portrait;Moulder",
      "add_portrait;Vanessa;FarRight",
      "speak;Vanessa;No matter the obstacles, we will perform our duty.",
      "remove_portrait;Vanessa",
      "add_portrait;Gilliam;FarRight",
      "speak;Gilliam;Our lives are yours.",
      "remove_portrait;Gilliam",
      "speak;Hayden;These are some of my most trusted and stalwart vassals. |They will, no doubt, prove themselves quite valuable on your journey. |Remember, you are venturing behind enemy lines. You will need supplies. |I will have a supply convoy readied to carry your weapons and provisions. |It will remain at your side, no matter how far afield you venture.",
      "speak;Eirika;King Hayden, I...{br}Thank you.",
      "speak;Hayden;No, save thanks for your return... with your brother, Prince Ephraim.",
      "speak;Eirika;Yes, Your Highness!",
      "remove_portrait;Eirika",
      "remove_portrait;Hayden",
      "give_money;5000",
      "transition;close;3000",
      "change_background;InsideCastle",
      "transition;open",
      "add_portrait;Eirika;Right",
      "add_portrait;Tana;Left",
      "speak;Tana;Eirika, you don't really intend to go through with this, do you? |I can't guess how you feel, but it's just too dangerous. |What would happen if you were captured by Grado's men?",
      "speak;Eirika;Thank you for your concern, Tana. |But I have no choice. Don't you see, Tana? I have to go.",
      "speak;Tana;Eirika...{br} Oh, why is this happening? What's gone wrong with the world?",
      "speak;Eirika;Tana...",
      "speak;Tana;Why would Grado invade? |Emperor Vigarde is a man of peace. His people adore him. |And you and Ephraim are friends with Prince Lyon, are you not? |What could be behind this madness? Why is this happening...",
      "speak;Eirika;I have no answers for you, Tana. |I don't want to believe it, but the reality is that we are at war. |If I do nothing, I may lose my brother as well as my father. |This is why I have to fight. It's the only answer I have.",
    ],
  },
];

